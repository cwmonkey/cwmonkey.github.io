window.cwmElementSelector=window.cwmElementSelector||{},window.cwmElementSelector.load=function(e,t){"use strict";var n,o,l,s='<link rel="stylesheet" id="place-image-css"/>',r=function(e,t){t=t||[];var n="";e.is("[id]")&&(n="#"+e.attr("id"));var o="";e[0].className&&(o="."+e[0].className.split(" ").join(".")),t.unshift(e[0].tagName+n+o);var l=e.parent();return l.length&&"HTML"!=l[0].tagName?r(l,t):t.join(" > ")},a=function(e,t,n){if(n=n||0,t=t||[],e.is("a")&&0===n)return t.push("a"),n++,a(e.parent(),t,n);if(e[0].className&&0!==n)return"."+e[0].className.split(" ").join(".")+(t.length?" "+t.join(" "):"");var o="";e[0].className?(o="."+e[0].className.split(" ").join("."),t.unshift(o)):0===n&&t.unshift(e[0].tagName);var l=e.parent();return l.length&&"BODY"!=l[0].tagName?(n++,a(l,t,n)):t.join(" ")},c={get_selector:r,by_class:a},i=function(e){var n=t(this);e.stopPropagation(),l.empty();for(var o in c){var s=c[o];l.append(t("<p/>").html(s(n)))}n.addClass("element-selector-hover")},m=function(e){var n=t(this);e.stopPropagation(),n.removeClass("element-selector-hover")},u=function(e){var n=t(this);e.stopPropagation(),e.preventDefault(),n.removeClass("element-selector-hover"),d(),l.empty();for(var o in c){var s=c[o],r=t('<input type="text"/>').val(s(n));l.append(t("<p/>").append(r))}setTimeout(function(){l.find('input[type="text"]').focus().select().bind("click focus",function(){var e=t(this);setTimeout(function(){e.select()},0)})},0),l.append(t("<p/>").append(t("<button/>").html("Close").bind("click",function(e){e.preventDefault(),v()})))},p=function(){var e=t(this);e.is(".element-selector-hovered")?e.removeClass("element-selector-hovered"):e.addClass("element-selector-hovered")},d=function(){o.undelegate(":not(#element-selector-selector)","mouseover",i).undelegate(":not(#element-selector-selector)","mouseout",m).undelegate(":not(#element-selector-selector)","click",u).undelegate("#element-selector-selector","mouseover",p),g=!1},v=function(){l.empty().hide()},f=function(){n=t(s).appendTo("head"),n.attr({href:e.cwmBookmarkletUrl+"/element-selector.css?"+(new Date).getTime()}),o=t("html"),l=t("<menu/>").attr({id:"element-selector-selector"}).appendTo(o).bind("focusout",function(){})},h=function(){g=!0,o.delegate(":not(#element-selector-selector)","mouseover",i).delegate(":not(#element-selector-selector)","mouseout",m).delegate(":not(#element-selector-selector)","click",u).delegate("#element-selector-selector","mouseover",p),l.show()},g=!1;f();var w=function(){g||h()};e.cwmElementSelector={main:w}};