!function(){var e,t,a,n,l,i,o,r,s=!1,d=$("body"),c='<link rel="stylesheet" id="trello-swimlane-navigation-css"/>';$css=$(c).appendTo("head"),$css.attr({href:window.cwmBookmarkletUrl+"/trello-swimlane-navigation.css?2"});var m=function(){return document.location.pathname.split("/")[2]};d.delegate(".lane-menu-toggle","click",function(e){e.preventDefault(),l.is(".lane-menu-hide")?(l.removeClass("lane-menu-hide"),localStorage.removeItem("lane-menu-hide")):(l.addClass("lane-menu-hide"),localStorage.setItem("lane-menu-hide",1))});var f=function(){return"undefined"==typeof jQuery?void setTimeout(f,500):void function(d){d(function(){if(e=d("#board"),a=d(".board-canvas"),l=d("#content"),r=localStorage.getItem("lane-menu-hide"),r&&l.addClass("lane-menu-hide"),t=d(".board-wrapper"),n=e.find(".list"),i=e.find(".list-card"),o=d("#trello-swimlane-navigation-css"),!(o.length&&("loaded"==o.css("content")||'"loaded"'==o.css("content"))&&l.length&&t.length&&a.length&&e.length&&n.length&&i.length))return void setTimeout(f,500);var c=d("<menu/>").addClass("lane-menu u-fancy-scrollbar"),u=localStorage.getItem("order:"+m()),g=null;if(u&&(u=JSON.parse(u),g={}),$members=d(".board-widget-members"),n.each(function(){var e=d(this),t=e.find(".list-header-name").text();if(t){var a=t.split(/[ \-]/),n=a[0],l=$members.find('img[alt^="'+t+'"], img[alt^="'+t.toLowerCase()+'"], .member-initials[title^="'+t+'"], .member-initials[title^="'+t.toLowerCase()+'"]');l.length||(l=$members.find('img[alt^="'+n+'"], img[alt^="'+n.toLowerCase()+'"], .member-initials[title^="'+n+'"], .member-initials[title^="'+n.toLowerCase()+'"]'));var i=d("<button/>").html('<span class="lane-menu-name">'+t+"</span>");l.length&&i.prepend(l.eq(0).clone()),i.data("target",e),u?g[t]=i:c.append(i)}}),u){for(var p=0;p<u.length;p++){var h=g[u[p]];c.append(h),g[u[p]]=""}for(var v in g)g.hasOwnProperty(v)&&""!=g[v]&&c.append(g[v])}var b=d("<div/>").addClass("lane-menu-wrapper");b.append('<a href="#" class="lane-menu-toggle dark-hover js-hide-sidebar" title="Show/hide swimlane navbar."><span class="icon-sm icon-leftarrow"></span><span class="icon-sm icon-rightarrow"></span></a>').append(c),l.prepend(b);var w=b.width();if(l.css({"padding-left":w+10}),b.css({left:-1*(w+10)}),c.delegate("button","click",function(t){t.preventDefault();var a=d(this),n=a.data("target"),l=n.position().left+e.scrollLeft();e.animate({scrollLeft:l},"fast"),localStorage.setItem("scrollToLeft",l)}).sortable({items:"> button",cancel:"",stop:function(){var e=c.find("button"),t=[];e.each(function(){var e=d(this);t.push(e.find(".lane-menu-name").text())}),localStorage.setItem("order:"+m(),JSON.stringify(t))}}).disableSelection(),!s){s=!0;var S=!1;e.bind("scroll",function(){S||(S=!0,setTimeout(function(){localStorage.setItem("scrollToLeft",e.scrollLeft()),S=!1},100))});var L=localStorage.getItem("scrollToLeft");L&&e.animate({scrollLeft:L},"fast")}var I=setInterval(function(){b.parent().length||(b.remove(),clearInterval(I),f())},500)})}(window.jQuery)};f()}();