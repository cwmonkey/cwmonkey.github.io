!function(){var e,t,a,n,l,o,r,i,s=!1,c=$("body"),d='<link rel="stylesheet" id="trello-swimlane-navigation-css"/>';$css=$(d).appendTo("head"),$css.attr({href:window.cwmBookmarkletUrl+"/trello-swimlane-navigation.css?2"});var m=function(){return document.location.pathname.split("/")[2]};c.delegate(".lane-menu-toggle","click",function(e){e.preventDefault(),l.is(".lane-menu-hide")?(l.removeClass("lane-menu-hide"),localStorage.removeItem("lane-menu-hide")):(l.addClass("lane-menu-hide"),localStorage.setItem("lane-menu-hide",1))});var f=function(){return"undefined"==typeof jQuery?void setTimeout(f,500):void function(c){c(function(){if(e=c("#board"),a=c(".board-canvas"),l=c("#content"),i=localStorage.getItem("lane-menu-hide"),i&&l.addClass("lane-menu-hide"),t=c(".board-wrapper"),n=e.find(".list"),o=e.find(".list-card"),r=c("#trello-swimlane-navigation-css"),!(r.length&&("loaded"==r.css("content")||'"loaded"'==r.css("content"))&&l.length&&t.length&&a.length&&e.length&&n.length&&o.length))return void setTimeout(f,500);var d=c("<menu/>").addClass("lane-menu u-fancy-scrollbar"),u=localStorage.getItem("order:"+m()),p=null;if(u&&(u=JSON.parse(u),p={}),$members=c(".board-widget--members"),n.each(function(){var e=c(this),t=e.find(".list-header-name").text();if(t){var a=t.split(/[ \-]/),n=a[0],l=$members.find('img[alt^="'+n+'"], img[alt^="'+n.toLowerCase()+'"], .member-initials[title^="'+n+'"], .member-initials[title^="'+n.toLowerCase()+'"]'),o=c("<button/>").html('<span class="lane-menu-name">'+t+"</span>");l.length&&o.prepend(l.eq(0).clone()),o.data("target",e),u?p[t]=o:d.append(o)}}),u){for(var g=0;g<u.length;g++){var h=p[u[g]];d.append(h),p[u[g]]=""}for(var v in p)p.hasOwnProperty(v)&&""!=p[v]&&d.append(p[v])}var b=c("<div/>").addClass("lane-menu-wrapper");b.append('<a href="#" class="lane-menu-toggle dark-hover js-hide-sidebar" title="Show/hide swimlane navbar."><span class="icon-sm icon-leftarrow"></span><span class="icon-sm icon-rightarrow"></span></a>').append(d),l.prepend(b);var w=b.width();if(l.css({"padding-left":w+10}),b.css({left:-1*(w+10)}),d.delegate("button","click",function(t){t.preventDefault();var a=c(this),n=a.data("target"),l=n.position().left+e.scrollLeft();e.animate({scrollLeft:l},"fast"),localStorage.setItem("scrollToLeft",l)}).sortable({items:"> button",cancel:"",stop:function(){var e=d.find("button"),t=[];e.each(function(){var e=c(this);t.push(e.find(".lane-menu-name").text())}),localStorage.setItem("order:"+m(),JSON.stringify(t))}}).disableSelection(),!s){s=!0;var S=!1;e.bind("scroll",function(){S||(S=!0,setTimeout(function(){localStorage.setItem("scrollToLeft",e.scrollLeft()),S=!1},100))});var I=localStorage.getItem("scrollToLeft");I&&e.animate({scrollLeft:I},"fast")}var L=setInterval(function(){b.parent().length||(b.remove(),clearInterval(L),f())},500)})}(window.jQuery)};f()}();