/*!
 * Simple History v0.5.0
 *
 * Copyright 2011, JÃ¶rn Zaefferer
 * Dual licensed under the MIT or GPL Version 2 licenses.
 */
!function(e){var t=location.href;e.SimpleHistory={supported:!(!e.history||!e.history.pushState),pushState:function(e,t){t=t||{},history.pushState(t,null,e),this.notify(t)},replaceState:function(e,t){t=t||{},history.replaceState(t,null,e)},notify:function(e){this.matcher(location.pathname+location.search,e)},start:function(n){this.matcher=n,e.addEventListener("popstate",function(e){return t&&t===location.href?void(t=null):void SimpleHistory.notify(e.state||{})},!1)}}}(window),function(e,t){var n="TransitionEvent"in e;t.addClassWait=function(e,a){var o=new t.Deferred,s=parseFloat(e.css("transition-duration"));if(!n||isNaN(s)||!s)return e.addClass(a),o.resolve(),o;var i=function(){e.unbind("transitionend",i),o.resolve()};return e.bind("transitionend",i).addClass(a),o}}(window,jQuery),function(e,t){t.load=function(e,n){var a=new t.Deferred;return e.load(n,function(){a.resolve()}),a}}(window,jQuery),function(e,t){t("html").removeClass("no-js").addClass("js");var n,a,o=t("body");if(o.delegate(".secondary .item","mouseenter focusin",function(){var e=t(this);clearTimeout(n),n=setTimeout(function(){e.removeClass("has_no_focus").addClass("has_focus")},0)}).delegate(".secondary .item","mouseleave focusout",function(){var e=t(this);clearTimeout(a),a=setTimeout(function(){e.removeClass("has_focus").addClass("has_no_focus")},0)}).delegate(".secondary .item","click",function(){var e=t(this);e.closest(".has_focus").removeClass("has_focus").addClass("has_no_focus")}),SimpleHistory.supported){var s,i=t("#main").attr("tabIndex","-1"),r=t("title"),l=t("<div/>"),c=function(n){t.when(t.load(l,n+" #main, title"),t.addClassWait(i,"loading")).done(function(){i.html(l.find("#main").html()),r.html(l.find("title").html()),i.addClass("unloaded").removeClass("loading").removeClass("unloaded"),e.scrollTo(0,0),ga("send","pageview",n),u()})},d={"^/greasemonkey/make-note":function(){!function(){var e="/greasemonkey/make-note/make-note-script.js";document.head.appendChild(document.createElement("script")).src=e+"?"+(new Date).getTime()}()}},u=function(){var e;for(var t in d)if(d.hasOwnProperty(t)&&document.location.pathname.match(new RegExp(t))){e=d[t],e();break}};o.delegate('a[href^="/"]',"click",function(e){e.metaKey||e.shiftKey||e.ctrlKey||t(this).data("noajax")||(e.preventDefault(),s=t(e.target).attr("href"),SimpleHistory.pushState(e.target.href))}).delegate(".secondary .headline a","click",function(e){e.preventDefault(),o.is(".navopen")?o.removeClass("navopen"):o.addClass("navopen")}).delegate(".secondary .list a","click",function(){o.removeClass("navopen")}),SimpleHistory.start(function(e){c(e)})}}(window,jQuery);